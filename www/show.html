<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <link rel="stylesheet" href="components/loader.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="components/loader.js"></script>
    <script src="js/ncmb-2.1.1.min.js"></script>
    <script>
        
        $(function() {
            //mBaaSの初期化
            var application_key = "efa576f10d4276d54840cd0d977dfd5691c299f048beba77d988da6f0134e7ef";
            var client_key = "ee99cda55eb9bb8e288419f424fe0c6917c3c32a6fbb01c21fc0ffe271cead67";
            var ncmb = new NCMB(application_key, client_key); 
            var user = ncmb.User.getCurrentUser();
            
            // ログインチェック
            if (user === null) {
                location.href = "./index.html";
            } else {
                $("#youkoso").append("ようこそ " + user.userName + " さん！<br>" + "[ログアウトはこちら]");
            }
            
            // ログアウト
            $("#youkoso").on("click", function() {
                ncmb.User.logout()
                .then(function() {
                    location.href = "./index.html";
                })
            });
                
                
                $('#jusin').on('click', function() {
                     var Contents = ncmb.DataStore("Contents");
                    
                    Contents.limit(100)
                            .fetchAll()
                            .then(function(contents){
                              // $("#post").prepend(
                              $("#post").prepend(
                                    "<li>" + contents[ Math.floor( Math.random() * contents.length ) ].get("contents") + "</li><br>"
                                    );
                             })
                return false;
                });
                
                //クリアボタン
                $('#clear').on('click', function() {
                    $('#post').empty();
                });
                
                
                //戻るボタン
                $("#modoru").on("click", function() {
                    location.href = "./home.html";
                });
                  
                  
                  });
                  
                
        
    </script>
</head>
<body>
    <div id ="youkoso"></div>
        <div>
        <input id="jusin" type="submit" value="受信！">
        <input id="clear" type="submit" value="クリア">
        <input id="modoru" type="submit" value="戻る">
        </div>
    <h3>◇受信した投稿はこちら！</h3>
    <ol id="post"></ol>
</body>
</html>
